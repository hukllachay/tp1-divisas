<%- include('templates/header'); -%>
    <main>
        <div class="formulario-registro">
            <h2>Registro de nuevo usuario</h2>
            <!-- <form class="form-signin" method="POST" action="http://localhost:3000/usuarios/"> -->
            <form class="form-signin">
                <div class="form-group">
                    <label for="txtNombre">Nombres</label>
                    <input id="txtNombre" type="text" class="form-control" required name="nombre">
                </div>
                <div class="form-group">
                    <label for="txtApellidos">Apellidos</label>
                    <input id="txtApellidos" type="text" class="form-control" required name="apellidos">
                </div>
                <div class="form-group">
                    <label for="txtCorreo">Correo</label>
                    <input id="txtCorreo" type="email" class="form-control" required name="correo">
                </div>
                <div class="form-group">
                    <label for="cboTipoDocumento">Tipo de documento</label>
                    <select id="cboTipoDocumento" class="form-control" required name="id_tipo_documento">
                        <% data.tipoDocumentos.forEach(function(tipoDocumento) { %>
                            <option value="<%= tipoDocumento.id %>">
                                <%= tipoDocumento.name %>
                            </option>
                            <% }); %>
                    </select>
                </div>
                <div class="form-group">
                    <label for="txtNumeroDocumento">Número de documento</label>
                    <input id="txtNumeroDocumento" type="text" class="form-control" required name="N° documento">
                </div>
                <div class="form-group">
                    <label for="txtDireccion">Dirección</label>
                    <input id="txtDireccion" type="text" class="form-control" required name="direccion">
                </div>
                <div class="form-group">
                    <label for="txtContrasena">Contraseña</label>
                    <input id="txtContrasena" type="password" class="form-control" required name="contraseña">
                </div>
                <div class="form-group">
                    <label for="txtContrasena">Confirmar contraseña</label>
                    <input id="txtContrasenaValidate" type="password" class="form-control" required name="contraseña">
                </div>
                <div class="d-grid gap-2">
                    <button id="btnRegistrar" type="button" class="btn btn-light btn-continuar">Registrar usuario
                    </button>
                </div>
            </form>
        </div>
    </main>

    <script>
        let txtNombre = document.getElementById("txtNombre");
        let txtApellidos = document.getElementById("txtApellidos");
        let txtCorreo = document.getElementById("txtCorreo");
        let cboTipoDocumento = document.getElementById("cboTipoDocumento");
        let txtNumeroDocumento = document.getElementById("txtNumeroDocumento");
        let txtDireccion = document.getElementById("txtDireccion");
        let txtContrasena = document.getElementById("txtContrasena");
        let txtContrasenaValidate = document.getElementById("txtContrasenaValidate");
        let btnRegistrar = document.getElementById("btnRegistrar");

        btnRegistrar.onclick = function(){
            save();
        }

        function save() {
            let data = { item: {
                    name: txtNombre.value,
                    lastName: txtApellidos.value,
                    email: txtCorreo.value,
                    documentTypeId: cboTipoDocumento.value,
                    documentNumber: txtNumeroDocumento.value,
                    address: txtDireccion.value,
                    password: txtContrasena.value
                } 
            };

            let options = {
                method: 'POST',
                headers: {
                    "Content-type": "application/json; charset=UTF-8"
                },
                body: JSON.stringify(data)
            }

            var promise = fetch('/register/save', options);
            promise.then(response => {
                if (!response.ok) {
                    console.error(response)
                } else {
                    return response.json();
                }
            }).then(result => {
                console.log(result);
            })
        }

    </script>
    <%- include('templates/footer'); -%>